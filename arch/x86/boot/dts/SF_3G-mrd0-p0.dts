/dts-v1/;
#define SOFIA3G_ES2
#include "xgold/sofia_3g_soc/irq.h"

/ {
	#address-cells = <1>;
	#size-cells = <1>;
	model = "intel,sofia_3g_soc-es2";
	compatible = "intel,sofia_3g_soc-svb", "intel,xgold";

	#include "xgold/sofia_3g_soc/sofia_3g_soc.dtsi"
	#include "xgold/sofia_3g_soc/irq.dtsi"
	#include "xgold/sofia_3g_soc/clock-es2.dtsi"
	#include "xgold/sofia_3g_soc/regulator.dtsi"
	#include "xgold/sofia_3g_soc/device-pm-reg.dtsi"

	chosen {
	};

	aliases {
	};

	memory {
		device_type = "memory";
		reg = <0x800000 0x1800000>;
	};

	cpufreq:cpufreq {
		compatible = "intel,xgold-cpufreq";
		clocks = <&clk_cpu>,<&MUX_CPU>,<&B_0_1>,<&G_0_1>;
		clock-names = "core","mux","pll","bank";
		intel,cpufreq-table = <208000 728000 1040000>;
/*		intel,cpufreq-table = <208000 312000 416000>;*/
		#address-cells = < 0 >;
		interrupts = < 0 >;
	        interrupt-parent = <&cpufreq>;
	        #interrupt-cells = < 1 >;
	        interrupt-map = < 0 &hirq HIRQ_CPU_CLK_CHANGE IRQ_TYPE_DEFAULT>;
	        interrupt-names = "CPU_CLK_CHANGE";

	};

	ion {
		compatible = "intel,ion";
		cma-heap {
			intel,heapmem = <   0x00000000 0x08000000 >;
		};
	};

	backlight:backlight {
		compatible = "intel,led-bl";
		reg = <0xE6501800 0x154>;
		intel,flags-use-safe-ctrl;
		pm,class-name = "bl_class";
		pm,user-name = "bl";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};

#ifndef RECOVERY_KERNEL
	headset:headset {
		compatible = "intel,headset";
		#address-cells = < 0 >;
		reg = <0xE6501C00 0x4>;
		reg-names = "headset-registers";
		interrupts = < 0 1 >;
		interrupt-parent = < &headset>;
		#interrupt-cells = < 1 >;
		interrupt-map = <
			 0 &ag620_pmu ABB_PMU_ACD1 XGOLD_IRQ_TYPE_NONE
			 1 &ag620_pmu ABB_PMU_ACD2 XGOLD_IRQ_TYPE_NONE
			>;
		interrupt-names = "acd1", "acd2";
		io-channel-names = "ACCID_ADC";
		io-channels = < &meas 4 >;
	};
#endif
	lcd:lcd {
		compatible = "intel,lcd";
		pm,class-name = "generic_class";
		pm,user-name = "lcd";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};

	graphics {
		compatible = "intel,graphics";
		intel,gpu-shared-mem = <0x20000000>;
		intel,dcc-fbpixelformat= "RGB888";
		intel,dcc-debug-level = <1>;
#ifdef RECOVERY_KERNEL
		intel,fb-api = <1>;
		intel,dcc-mem = < 0x00800000 >;
#else
		intel,dcc-use-fences = <0>;
		intel,dcc-mem = < 0x00400000 >;
#endif
		intel,display-fps = <60>;
		intel,display-ramless = <1>;
		intel,display-preinit = <0>;
		intel,display-if = <&mipi_dsi>;
		intel,display-if-rate = <450000000>;
		/include/ "xgold/display/OTM1283.dtsi"
		mipi_dsi:mipi-dsi {
				intel,display-if-min = <104000000>;
				intel,display-if-max = <550000000>;
				intel,display-if-nblanes = <4>;
				intel,display-if-phy-pwup = <6>;
				intel,display-if-phy-calib = <3>;
				intel,display-if-phy-to_lp_hs_req = <24>;
				intel,display-if-phy-to_lp_hs_dis = <25>;
				intel,display-if-phy-to_lp_hs_eot = <60>;
				intel,display-if-phy-to_hs_zero = <8>;
				intel,display-if-phy-to_hs_flip = <24>;
				intel,display-if-phy-lp_clk_div = <31>;
				intel,display-if-phy-to_hs_clk_pre = <36>;
				intel,display-if-phy-to_hs_clk_post = <42>;
				intel,display-if-phy-data_delay = <7>;
				intel,display-if-phy-clock_delay = <7>;
				intel,display-if-phy-lp_tx_tfall = <2>;
				intel,display-if-phy-lp_tx_rise = <2>;
				intel,display-if-phy-lp_tx_vref = <31>;
		};
	};

#ifndef RECOVERY_KERNEL
	sound {
		compatible = "intel,xgold-snd-asoc";
		intel,audio-codec = < &afe >;
		intel,pcm-audio = <&pcm_music>;
		intel,pcm-voice = <&pcm_voice>;
		intel,speech = <&speech_probe>;
	};
#endif

};

&idi_per {
	#include "xgold/agold620/agold620.dtsi"
};

&dcc {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&dif_default_pins>;
	pinctrl-1 = <&dif_sleep_pins>;
	pinctrl-2 = <&dif_inactive_pins>;
};

&usif1 {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&usif1_default_pins>;
	pinctrl-1 = <&usif1_sleep_pins>;
	pinctrl-2 = <&usif1_inactive_pins>;
};

&usif2 {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&usif2_function_B_active_pins>;
	pinctrl-1 = <&usif2_function_B_sleep_pins>;
	pinctrl-2 = <&usif2_function_B_inactive_pins>;
};

&i2c_1 {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&i2c1_default_pins>;
	pinctrl-1 = <&i2c1_sleep_pins>;
	pinctrl-2 = <&i2c1_inactive_pins>;

#ifndef RECOVERY_KERNEL
	afc0: af-controller@0 {
		compatible = "whitus vision,wv511-v4l2-i2c-subdev";
		reg = < 0x0C >;
	};

	camera0: camera-module@0 {
		compatible = "omnivision,ov13850-v4l2-i2c-subdev";
		reg = < 0x36 >;
		device_type = "v4l2-i2c-subdev";

		pinctrl-names = "default", "sleep", "inactive";
		pinctrl-0 = <&cam1_default_pins>;
		pinctrl-1 = <&cam1_sleep_pins>;
		pinctrl-2 = <&cam1_inactive_pins>;

		intel,pd-gpio = <&xgold_pmx_gpio 39>;
		intel,pd-gpio_1v2 = <&xgold_pmx_gpio 68>;
		intel,pd-gpio-is_active_low;
		intel,flash-gpio = <&xgold_pmx_gpio 37>;
		intel,torch-gpio = <&xgold_pmx_gpio 38>;

		pm,class-name = "generic_class";
		pm,user-name = "primcam";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";

		/* ["front","back"] */
		intel,camera-module-facing = "back";
		/* ["landscape","landscape-flipped","portrait","portrait-flipped"] */
		intel,camera-module-mounting = "landscape";
		intel,camera-module-flash-support = <1>;
		intel,camera-module-flash-exp-time = <5000>;

		intel,af-ctrl = <&afc0>;

		intel,camera-module-csi-config-0 {
			intel,csi-pixels-per-second = <0>;
			intel,csi-vc = <0>;
			intel,csi-lanes = <2>;
			intel,csi-dphy1 = <0x2014183>;
			intel,csi-dphy2 = <0x00>;
			intel,csi-ana-bandgap-bias = <3>;
		};
		intel,camera-module-csi-config-1 {
			intel,csi-pixels-per-second = <100000000>;
			intel,csi-vc = <0>;
			intel,csi-lanes = <4>;
			intel,csi-dphy1 = <0x600E1C1>;
			intel,csi-dphy2 = <0x00>;
			intel,csi-ana-bandgap-bias = <3>;
		};
	};
#endif
#ifndef RECOVERY_KERNEL
	camera1: camera-module@1 {
		compatible = "omnivision,ov9760-v4l2-i2c-subdev";
		reg = < 0x10 >;
		device_type = "v4l2-i2c-subdev";

		pinctrl-names = "default", "sleep", "inactive";
		pinctrl-0 = <&cam2_default_pins>;
		pinctrl-1 = <&cam2_sleep_pins>;
		pinctrl-2 = <&cam2_inactive_pins>;

		intel,pd-gpio = <&xgold_pmx_gpio 40>;
		intel,pd-gpio-is_active_low;

		pm,class-name = "generic_class";
		pm,user-name = "seccam";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";

		intel,camera-module-facing = "front";
		/* ["landscape","landscape-flipped","portrait","portrait-flipped"] */
		intel,camera-module-mounting = "landscape";
		intel,camera-module-flash-support = <1>;
		intel,camera-module-flash-exp-time = <5000>;

		intel,camera-module-csi-config-0 {
			intel,csi-pixels-per-second = <0>;
			intel,csi-vc = <0>;
			intel,csi-lanes = <1>;
			intel,csi-dphy1 = <0x60121A9>;
			intel,csi-dphy2 = <0x00>;
			intel,csi-ana-bandgap-bias = <3>;
		};

	};
#endif
#ifndef RECOVERY_KERNEL
	touchscreen {
		compatible = "goodix,Goodix-TS";
		reg = < 0x14 >;
		interrupt-parent = <&eint>;
		interrupts = < EINT_EXI0 XGOLD_IRQ_TYPE_EDGE_FALLING >;
		pinctrl-names = "default", "sleep", "inactive", "gpio";
		pinctrl-0 = <&touch_default_pins>;
		pinctrl-1 = <&touch_sleep_pins>;
		pinctrl-2 = <&touch_inactive_pins>;
		pinctrl-3 = <&touch_gpio_pins>;
		intel,ts-gpio-reset = <&xgold_pmx_gpio 32>;
		intel,ts-gpio-irq = <&xgold_pmx_gpio 66>;
		pm,class-name = "gt9xx_class";
		pm,user-name = "tp";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};
#endif
};

&i2c_2 {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&i2c2_default_pins>;
	pinctrl-1 = <&i2c2_sleep_pins>;
	pinctrl-2 = <&i2c2_inactive_pins>;

#ifndef RECOVERY_KERNEL
	accelerometer {
		compatible = "stm,lsm303dlhc_acc";
		reg = < 0x19 >;
		interrupt-parent = <&eint>;
		interrupts = < EINT_EXI12 XGOLD_IRQ_TYPE_LEVEL_HIGH >;
		intel,axis-map = < 1 0 2 >;
		intel,negate = < 1 0 0 >;
		intel,poll-interval = < 100 >;
		pinctrl-names = "default", "sleep", "inactive";
		pinctrl-0 = <&accel_default_pins>;
		pinctrl-1 = <&accel_sleep_pins>;
		pinctrl-2 = <&accel_inactive_pins>;
		pm,class-name = "lsm303dlhc_acc_class";
		pm,user-name = "accelerometer";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};
#endif
#ifndef RECOVERY_KERNEL
	magnetometer {
		compatible = "stm,lsm303dlhc_mag";
		reg = < 0x1e >;
		intel,axis-map = < 1 0 2 >;
		intel,negate = < 1 0 0 >;
		intel,offset = < 0 0 0 >;
		intel,poll-interval = < 100 >;
		pm,class-name = "lsm303dlhc_mag_class";
		pm,user-name = "compass";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};
#endif
#ifndef RECOVERY_KERNEL
	proxsensor {
		compatible = "avago,apds990x";
		reg = < 0x39 >;
		interrupt-parent = <&eint>;
		interrupts = < EINT_EXI11 XGOLD_IRQ_TYPE_EDGE_FALLING >;
		pinctrl-names = "default", "sleep", "inactive";
		pinctrl-0 = <&prox_default_pins>;
		pinctrl-1 = <&prox_sleep_pins>;
		pinctrl-2 = <&prox_inactive_pins>;
		intel,pdrive = /bits/ 8 < 64 >;
		intel,ppcount = /bits/ 8 < 64 >;
		intel,als-gain = < 713 >;
		intel,coeff-B = < 204 >;
		intel,coeff-C = < 98 >;
		intel,coeff-D = < 197 >;
		vdd-supply = <&laux2>;
		vled-supply = <&laux1>; /* VBAT in fact, but since VBAT is not controllable, and VAUX1 is required for INT pull up, assigned VAUX1 to VLED instead. */
		pm,class-name = "apds990x_class";
		pm,user-name = "proximity";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};
#endif
#ifndef RECOVERY_KERNEL
	gyroscope {
		compatible = "stm,l3gd20_gyr";
		reg = < 0x6a >;
		interrupt-parent = <&eint>;
		interrupts = < EINT_EXI1 XGOLD_IRQ_TYPE_EDGE_RISING >;
		pinctrl-names = "default", "sleep", "inactive";
		pinctrl-0 = <&gyroscope_default_pins>;
		pinctrl-1 = <&gyroscope_sleep_pins>;
		pinctrl-2 = <&gyroscope_inactive_pins>;
		intel,axis-map = < 1 0 2 >; /* spec is wrong, x and y are interchanged */
		intel,negate = < 1 0 0 >;
		intel,poll-interval = < 100 >;
		intel,full-scale = < 2000 >;
		pm,class-name = "l3gd20_class";
		pm,user-name = "gyroscope";
		pm,state-D0 = "enable";
		pm,state-D3 = "disable";
	};
#endif
};

&i2c_5 {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&i2c5_agold_default_pins>;
	pinctrl-1 = <&i2c5_agold_sleep_pins>;
	pinctrl-2 = <&i2c5_agold_inactive_pins>;
	bat:battery {
		compatible = "intel,fan54x_charger";
		reg = < 0x6b >;
		interrupts = < 0 >;
		interrupt-parent = < &bat>;
		#interrupt-cells = < 1 >;
		interrupt-map = < 0 &ag620_pmu ABB_PMU_CI XGOLD_IRQ_TYPE_NONE >; /* CI */
		pinctrl-names = "default", "sleep", "inactive", "active";
		pinctrl-0 = < &chgreset_agold_default_pins >;
		pinctrl-1 = < &chgreset_agold_sleep_pins >;
		pinctrl-2 = < &chgreset_agold_inactive_pins >;
		pinctrl-3 = < &chgreset_agold_active_pins >;
	};
};

&gnss {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&tcxo_agold_default_pins>;
	pinctrl-1 = <&tcxo_agold_sleep_pins>;
	pinctrl-2 = <&tcxo_agold_inactive_pins>;
};

&backlight {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&cabc_agold_default_pins>;
	pinctrl-1 = <&cabc_agold_sleep_pins>;
	pinctrl-2 = <&cabc_agold_inactive_pins>;
};

#ifndef RECOVERY_KERNEL
&afe {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&dm_agold_default_pins>;
	pinctrl-1 = <&dm_agold_sleep_pins>;
	pinctrl-2 = <&dm_agold_inactive_pins>;
};
#endif

&sd {
	intel,tap_values = <0x080400F5 0x08040004 0x00040004 0x08040004 0x5CF501A5 0x00F500A5 0x00F500A5>;
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&sdmmc_default_pins>;
	pinctrl-1 = <&sdmmc_sleep_pins>;
	pinctrl-2 = <&sdmmc_inactive_pins>;
};

&emmc {
	intel,tap_values = <0x080400F5 0x08040004 0x00040004 0x08040004 0x08040004 0x000400B5 0x000400B5>;
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&emmc_default_pins>;
	pinctrl-1 = <&emmc_sleep_pins>;
	pinctrl-2 = <&emmc_inactive_pins>;

};

&keypad {
	pinctrl-names = "default", "sleep", "inactive";
	pinctrl-0 = <&kp_default_pins>;
	pinctrl-1 = <&kp_sleep_pins>;
	pinctrl-2 = <&kp_inactive_pins>;
	keypad,num-rows = <4>;
	keypad,num-columns = <8>;
	keypad,rows = <0 2 3>;
	keypad,columns = <0 1 2>;
	linux,keymap = <0x00000073	/* KEY_VOLUMEUP */
			0x00010066	/* KEY_HOME */
			0x00020000	/* KEY_RESERVED */
			0x00030000	/* KEY_RESERVED */
			0x00040000	/* KEY_RESERVED */
			0x00050000	/* KEY_RESERVED */
			0x00060000	/* KEY_RESERVED */
			0x00070000	/* KEY_RESERVED */
			0x01000000	/* KEY_RESERVED */
			0x01010000	/* KEY_RESERVED */
			0x01020000	/* KEY_RESERVED */
			0x01030000	/* KEY_RESERVED */
			0x01040000	/* KEY_RESERVED */
			0x01050000	/* KEY_RESERVED */
			0x01060000	/* KEY_RESERVED */
			0x01070000	/* KEY_RESERVED */
			0x02000072	/* KEY_VOLUMEDOWN */
			0x02010000	/* KEY_RESERVED */
			0x02020000	/* KEY_RESERVED */
			0x03000074>;	/* KEY_POWER */
};

#ifndef RECOVERY_KERNEL
&cif {
	intel,camera-modules-attached = <&camera0 &camera1>;
};
#endif

#include "xgold/agold620/pinctrl-sf_3g-es2-svb.dtsi"
#include "xgold/sofia_3g_soc/pinctrl-sf_3g-es2-svb.dtsi"
